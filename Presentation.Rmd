---
title: "Explaining suicide in Italian counties"
author: "Pietro Romozzi & Federico Colombo-Ercole"
date: "02 dicembre 2014"
output:
  ioslides_presentation:
    css: http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css
    logo: https://raw.githubusercontent.com/christophergandrud/Hertie_Collab_Data_Science/master/img/HertieCollaborativeDataLogo_v1.png

---

# What and Why

## A quick background:

- Among young adults (15-29), suicide accounts for 8.5% of all deaths: *second leading cause of death* (after traffic accidents). 
- Among adults (30-49) suicide accounts for 4.1% of all deaths: *fifth leading cause of death*.

(see the latest "Prevent Suicide" report by WHO)

- "The debate about the impact of climate change on human health has, very recently, included consideration of mental health" (Berry, Bowen & Kjellstrom, 2009).

- The *mental health vs climate* relationship still needs to be studied into details (**research gap**).

## Research question:

*How do climate factors affect suicide rate in the Italian context?*

- Is suicide rate lower whereby the average temperature is higher?
- Is suicide rate higher whereby the average temperature range is higher?
- Is suicide rate higher whereby precipitations happen more frequently?

# Methodology

## Case selection: {.smaller}

Previous study: regional data, 20 observations, unsignificant model.

Now, Italy is still our focus: *county-level data* provide 110 observations!

```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(ggmap)

location <- "Italy"

qmap(location = "Roma", zoom = 6, maptype = "hybrid")

```


## Our Models: 

$$
LogStSuicideRate = \alpha + \beta_{1}LogGDPPerCapita + \beta_{2}LogUnemploymentRate
$$
$$
+ \beta_{3}LogPopulation + \beta_{4}LogGiniIndex + \beta_{5}LogAverageTemperature 
$$
$$
+ \beta_{6}LogAverageTemperatureRange + \beta_{7}LogAveragePrecipitations + e
$$


$$
LogSuicideRate = \alpha + \beta_{1} + \beta_{2}LogUnemploymentRate 
$$
$$
+ \beta_{3}LogPopulation + \beta_{4}LogAverageTemperature 
$$
$$
+ \beta_{5}LogAveragePrecipitations + e
$$

--------

```{r, echo=FALSE, results='asis'}

# Loading tidy data frames that we have to merge.

meteo <- read.csv("climate_data.csv", header = TRUE, sep = ";", dec = ",",fill = TRUE)

gdp <- read.csv("gdp_data.csv", header = T, sep =";", dec = ",", fill = T)

main <- read.csv("socio_eco_data.csv", header = T, sep =";", dec = ",", fill = T)
  
# Merging

Merging1 <- merge(x = main , y = meteo , by = "county", all = T )

Dataset <- merge(x = Merging1, y = gdp, by = "county", all = T )
```

```{r, results='asis', echo=FALSE, message=FALSE}
require("car")

car :: scatterplotMatrix(Dataset[2:9], main = "Scatterplot Matrix")
```

# Findings



-------
```{r, echo=FALSE, results='asis', message=FALSE}

library(stargazer)

LinModel1 <- lm(log(st_suicide_rate) ~ log(gdp_per_capita) + log(unemployment_rate) + log(population) + log(gini_index) + log(avg_temperature) + log(avg_temp_range) + log(avg_precipitations), data = Dataset)

LinModel2 <- lm(log(st_suicide_rate) ~ log(gdp_per_capita) + log(population) + log(avg_temperature) + log(avg_precipitations), data = Dataset)

labelstable <- c("GDP per capita", "Unemployment rate", "Population", "Gini index", "Average Temperature", "Temperature range", "Average Precipitations")

labelstable2 <- c("Model1", "Model2")

stargazer(LinModel1, LinModel2, title = "Models Comparison", type = "html", digits = 3, align = T, dep.var.labels = "St. suicide rate", covariate.labels = labelstable, clolumn.labels = labelstable2)
```


##Predicted Probabilities
```{r,message=FALSE,echo=FALSE,results='asis', warning=FALSE}

library(Zelig)

CompleteDataset <- na.omit(Dataset)

Z1 <- zelig (st_suicide_rate ~ gdp_per_capita + log(population) + avg_temperature + avg_precipitations, data = CompleteDataset, model = "ls")

x.out2 <- setx(Z1, avg_precipitations = 700:1200)

simz2 <- sim(Z1, x = x.out2)

plot(simz2, xlab = 'Average precipitations in mm, year 2009')

```

---------


```{r,message=FALSE,echo=FALSE,results='asis', warning=FALSE}
library(ggplot2)

LinModel2 <- lm(log(st_suicide_rate) ~ log(gdp_per_capita) + log(population) + log(avg_temperature) + log(avg_precipitations), data = Dataset)

ggplot2::ggplot(data = Dataset, aes(x = avg_precipitations, y = st_suicide_rate), message = F) + geom_point() + stat_smooth() + theme_bw() + ggtitle("Suicide Rate vs Precipitation in Italy")
```

##Conclusion

-Climate characteristics affect suicide rates in Italy
-Correlation not as strong as (we) would have expected
-Rain actually has a negative impact on suicidial behaviour (contrary to what is commonly believed)



